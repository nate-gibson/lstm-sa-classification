Layers.py by Aaron Brookhouse (https://github.com/ajbrookhouse/SelfAttention).